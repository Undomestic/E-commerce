<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lower Wear</title>
    <link rel="stylesheet" href="pantsyle.css">
</head>
<body>
    <header class="site-header">
        <div class="container header-row">
            <a href="#" class="brand" aria-label="Homepage">
                <span class="logo">âˆž</span>
                <span class="brand-name">Infinity Castle</span>
            </a>
<select class="nav-dropdown" onchange="location.href=this.value">
    <option disabled selected>Select Category</option>
        <option value="../home.html">Home</option>
    <option value="T-shirts.html">T-Shirts/Hoodies</option>
    <option value="Accessories.html">Accessories</option>
</select>

            <div class="actions">
                <label class="language">
                    <span>Language</span>
                    <select aria-label="Language">
                        <option>EN</option>
                        <option>ES</option>
                        <option>FR</option>
                        <option>HI</option>
                    </select>
                </label>
                <a href="../form/login.html" class="link">Hello, sign in</a>
                <a href="#" class="link">Returns & Orders</a>
                <a href="../cart.html" class="cart" aria-label="Cart">ðŸ›’</a>
                <button class="nav-toggle" aria-label="Toggle menu">â˜°</button>
            </div>
        </div>

        <nav class="mobile-drawer" aria-label="Mobile">
            <a href="../home.html">Home</a>
            <a href="#tshirts">Tâ€‘Shirts</a>
            <a href="#pants">Pants / Lowers</a>
            <a href="#accessories">Accessories</a>
            <a href="#about">About Us</a>
        </nav>
    </header>
    
    <div class="head"><h1>Welcome to Lower Wear</h1>
    <p>Your one-stop shop for stylish lower wear.</p></div>
   
    <div class="listProduct" id="productList">
        <!-- Static Product Cards -->
        <div class="product-card item" data-product-id="11">
            <img src="http://localhost:4000/images/Pants/11.jpg" alt="Sword Art Online Jeans" onerror="this.onerror=null; this.src='http://localhost:4000/images/Pants/11.jpg';">
            <h2>Attack on Titan Levi Ackerman Trousers</h2>
            <div class="price">â‚¹899</div>
            <div style="margin: 10px 0;">
                <button onclick="loadRecommendations(11)" style="margin-right: 5px; padding: 6px 12px; background: linear-gradient(135deg, var(--brand), var(--accent)); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-size: 12px; font-weight: bold;">
                    ðŸ‘– Outfit Match
                </button>
            </div>
            <input type="number" class="qty-input" value="1" min="1" style="width: 50px; padding: 5px; background: var(--card); color: var(--text); border: 1px solid var(--card-border); border-radius: 4px;">
            <button class="add-to-cart-btn" onclick="addProductToCart(this)" style="margin-top: 10px; padding: 8px 16px; background: var(--brand); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-weight: bold;">
                Add to Cart
            </button>
        </div>

        <div class="product-card item" data-product-id="12">
            <img src="http://localhost:4000/images/Pants/12.jpg" alt="Steins;Gate Trousers" onerror="this.onerror=null; this.src='http://localhost:4000/images/Pants/12.jpg';">
            <h2>Steins;Gate Okabe Rintarou Trousers</h2>
            <div class="price">â‚¹799</div>
            <div style="margin: 10px 0;">
                <button onclick="loadRecommendations(12)" style="margin-right: 5px; padding: 6px 12px; background: linear-gradient(135deg, var(--brand), var(--accent)); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-size: 12px; font-weight: bold;">
                    ðŸ‘– Outfit Match
                </button>
            </div>
            <input type="number" class="qty-input" value="1" min="1" style="width: 50px; padding: 5px; background: var(--card); color: var(--text); border: 1px solid var(--card-border); border-radius: 4px;">
            <button class="add-to-cart-btn" onclick="addProductToCart(this)" style="margin-top: 10px; padding: 8px 16px; background: var(--brand); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-weight: bold;">
                Add to Cart
            </button>
        </div>

        <div class="product-card item" data-product-id="13">
            <img src="http://localhost:4000/images/Pants/13.jpg" alt="Code Geass Chinos" onerror="this.onerror=null; this.src='http://localhost:4000/images/Pants/13.jpg';">
            <h2>My Hero Academia - Boku No Hero Academia Trousers</h2>
            <div class="price">â‚¹649</div>
            <div style="margin: 10px 0;">
                <button onclick="loadRecommendations(13)" style="margin-right: 5px; padding: 6px 12px; background: linear-gradient(135deg, var(--brand), var(--accent)); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-size: 12px; font-weight: bold;">
                    ðŸ‘– Outfit Match
                </button>
            </div>
            <input type="number" class="qty-input" value="1" min="1" style="width: 50px; padding: 5px; background: var(--card); color: var(--text); border: 1px solid var(--card-border); border-radius: 4px;">
            <button class="add-to-cart-btn" onclick="addProductToCart(this)" style="margin-top: 10px; padding: 8px 16px; background: var(--brand); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-weight: bold;">
                Add to Cart
            </button>
        </div>

        <div class="product-card item" data-product-id="14">
            <img src="http://localhost:4000/images/Pants/14.jpg" alt="Tokyo Ghoul Shorts" onerror="this.onerror=null; this.src='http://localhost:4000/images/Pants/14.jpg';">
            <h2> Sasuke Uchiha Naruto Shippuden Trousers</h2>
            <div class="price">â‚¹549</div>
            <div style="margin: 10px 0;">
                <button onclick="loadRecommendations(14)" style="margin-right: 5px; padding: 6px 12px; background: linear-gradient(135deg, var(--brand), var(--accent)); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-size: 12px; font-weight: bold;">
                    ðŸ‘– Outfit Match
                </button>
            </div>
            <input type="number" class="qty-input" value="1" min="1" style="width: 50px; padding: 5px; background: var(--card); color: var(--text); border: 1px solid var(--card-border); border-radius: 4px;">
            <button class="add-to-cart-btn" onclick="addProductToCart(this)" style="margin-top: 10px; padding: 8px 16px; background: var(--brand); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-weight: bold;">
                Add to Cart
            </button>
        </div>

        <div class="product-card item" data-product-id="15">
            <img src="http://localhost:4000/images/Pants/15.jpg" alt="Fullmetal Alchemist Formal Pants" onerror="this.onerror=null; this.src='http://localhost:4000/images/Pants/15.jpg';">
            <h2>Denji Chainsaw Man Trousers</h2>
            <div class="price">â‚¹999</div>
            <div style="margin: 10px 0;">
                <button onclick="loadRecommendations(15)" style="margin-right: 5px; padding: 6px 12px; background: linear-gradient(135deg, var(--brand), var(--accent)); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-size: 12px; font-weight: bold;">
                    ðŸ‘– Outfit Match
                </button>
            </div>
            <input type="number" class="qty-input" value="1" min="1" style="width: 50px; padding: 5px; background: var(--card); color: var(--text); border: 1px solid var(--card-border); border-radius: 4px;">
            <button class="add-to-cart-btn" onclick="addProductToCart(this)" style="margin-top: 10px; padding: 8px 16px; background: var(--brand); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-weight: bold;">
                Add to Cart
            </button>
        </div>

        <div class="product-card item" data-product-id="16">
            <img src="http://localhost:4000/images/Pants/16.jpg" alt="Mob Psycho Sports Shorts" onerror="this.onerror=null; this.src='http://localhost:4000/images/Pants/16.jpg';">
            <h2>Ichigo Kurosaki Bleach Trousers</h2>
            <div class="price">â‚¹399</div>
            <div style="margin: 10px 0;">
                <button onclick="loadRecommendations(16)" style="margin-right: 5px; padding: 6px 12px; background: linear-gradient(135deg, var(--brand), var(--accent)); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-size: 12px; font-weight: bold;">
                    ðŸ‘– Outfit Match
                </button>
            </div>
            <input type="number" class="qty-input" value="1" min="1" style="width: 50px; padding: 5px; background: var(--card); color: var(--text); border: 1px solid var(--card-border); border-radius: 4px;">
            <button class="add-to-cart-btn" onclick="addProductToCart(this)" style="margin-top: 10px; padding: 8px 16px; background: var(--brand); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-weight: bold;">
                Add to Cart
            </button>
        </div>

        <div class="product-card item" data-product-id="17">
            <img src="http://localhost:4000/images/Pants/17.jpg" alt="Ergo Proxy Khaki Pants" onerror="this.onerror=null; this.src='http://localhost:4000/images/Pants/17.jpg';">
            <h2>Goku Dragon Ball Z Trousers</h2>
            <div class="price">â‚¹749</div>
            <div style="margin: 10px 0;">
                <button onclick="loadRecommendations(17)" style="margin-right: 5px; padding: 6px 12px; background: linear-gradient(135deg, var(--brand), var(--accent)); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-size: 12px; font-weight: bold;">
                    ðŸ‘– Outfit Match
                </button>
            </div>
            <input type="number" class="qty-input" value="1" min="1" style="width: 50px; padding: 5px; background: var(--card); color: var(--text); border: 1px solid var(--card-border); border-radius: 4px;">
            <button class="add-to-cart-btn" onclick="addProductToCart(this)" style="margin-top: 10px; padding: 8px 16px; background: var(--brand); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-weight: bold;">
                Add to Cart
            </button>
        </div>

        <div class="product-card item" data-product-id="18">
            <img src="http://localhost:4000/images/Pants/18.jpg" alt="Cowboy Bebop Cargo Shorts" onerror="this.onerror=null; this.src='http://localhost:4000/images/Pants/18.jpg';">
            <h2>Flame Hashira Trousers</h2>
            <div class="price">â‚¹599</div>
            <div style="margin: 10px 0;">
                <button onclick="loadRecommendations(18)" style="margin-right: 5px; padding: 6px 12px; background: linear-gradient(135deg, var(--brand), var(--accent)); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-size: 12px; font-weight: bold;">
                    ðŸ‘– Outfit Match
                </button>
            </div>
            <input type="number" class="qty-input" value="1" min="1" style="width: 50px; padding: 5px; background: var(--card); color: var(--text); border: 1px solid var(--card-border); border-radius: 4px;">
            <button class="add-to-cart-btn" onclick="addProductToCart(this)" style="margin-top: 10px; padding: 8px 16px; background: var(--brand); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-weight: bold;">
                Add to Cart
            </button>
        </div>
    </div>

    <!-- Recommendations Section -->
    <div id="recommendationsSection" style="display: none; margin-top: 40px; padding: 20px; background: var(--panel); border: 1px solid var(--card-border); border-radius: 8px; margin-left: 20px; margin-right: 20px;">
        <h2 style="border-bottom: 2px solid var(--brand); padding-bottom: 10px; color: var(--accent); margin-top: 0;">ðŸ‘– Outfit Suggestions - What to Pair With This</h2>
        <p id="outfitTip" style="color: var(--muted); margin-bottom: 15px;"></p>
        <div class="listProduct" id="recommendationsList">
            <!-- Recommendations will be loaded here -->
        </div>
    </div>
      

    
    <script src="../cart.js"></script>
    <script>
        const navToggle = document.querySelector(".nav-toggle");
        const drawer = document.querySelector(".mobile-drawer");
        let currentProductId = null;

        navToggle.addEventListener("click", () => {
            drawer.classList.toggle("open");
            navToggle.classList.toggle("active");
        });

        document.addEventListener("click", (e) => {
            if (!drawer.contains(e.target) && !navToggle.contains(e.target)) {
                drawer.classList.remove("open");
                navToggle.classList.remove("active");
            }
        });

        // Load recommendations for a product
        async function loadRecommendations(productId) {
            try {
                const response = await fetch(`http://localhost:4000/api/recommendations/${productId}`);
                const data = await response.json();
                
                if (data.suggestions && data.suggestions.length > 0) {
                    currentProductId = productId;
                    const section = document.getElementById('recommendationsSection');
                    const tipEl = document.getElementById('outfitTip');
                    const recList = document.getElementById('recommendationsList');
                    
                    // Set outfit tip
                    tipEl.textContent = `Complete your "${data.product.name}" with these perfect matches!`;
                    
                    // Render recommendations
                    recList.innerHTML = data.suggestions.map(rec => {
                        const id = Number(rec.id);
                        let categoryFolder = "T-Shirts";
                        // ID range logic: match how your image folders are organized
                        if (!Number.isNaN(id)) {
                            if (id >= 1 && id <= 8) {
                                categoryFolder = "T-Shirts";
                            } else if (id >= 11 && id <= 18) {
                                categoryFolder = "Pants";
                            } else if (id >= 21 && id <= 28) {
                                categoryFolder = "Accessories";
                            }
                        } else if (rec.category) {
                            // More robust fallback
                            const cat = rec.category.toLowerCase();
                            if (cat.includes("shirt") || cat.includes("tee")) {
                                categoryFolder = "T-Shirts";
                            } else if (cat.includes("pants") || cat.includes("lower") || cat.includes("trouser")) {
                                categoryFolder = "Pants";
                            } else if (cat.includes("accessories") || cat.includes("accessory")) {
                                categoryFolder = "Accessories";
                            }
                        }
                        // Build image URL and details
                        const imageId = !Number.isNaN(id)
                            ? id
                            : (rec.name || rec.title || 'product').toLowerCase().replace(/\s+/g, '-');
                        const imageUrl = `http://localhost:4000/images/${categoryFolder}/${imageId}.jpg`;
                        const recName = rec.name || rec.title || "Product";
                        return `
                            <div class="product-card item" data-product-id="${rec.id}">
                                <img src="${imageUrl}" alt="${recName}">
                                <h2>${recName}</h2>
                                <div style="color: var(--brand); font-size: 12px; margin:8px 0;">
                                    ${rec.outfit_tip || ''}
                                </div>
                                <div class="price">â‚¹${rec.price}</div>
                                <input type="number" class="qty-input" value="1" min="1" style="width: 50px; padding: 5px; background: var(--card); color: var(--text); border: 1px solid var(--card-border); border-radius: 4px;">
                                <button class="add-to-cart-btn" onclick="addProductToCart(this)" style="margin-top: 10px; padding: 8px 16px; background: var(--brand); color: #0b0b0b; border: none; cursor: pointer; border-radius: 4px; font-weight: bold;">Add Match to Cart</button>
                            </div>
                        `;
                    }).join('');
                    
                    section.style.display = 'block';
                    section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            } catch (err) {
                console.error('Error loading recommendations:', err);
            }
        }

        // Products are static HTML now; no dynamic load needed
    </script>
</body>
</html>